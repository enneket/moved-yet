# 活动检测功能测试指南

## 功能概述

鼠标和键盘活动检测功能已经实现，包括：

### ✅ 已实现的功能

1. **配置项**
   - `movedYet.enableActivityDetection`: 启用/禁用活动检测（默认: true）
   - `movedYet.inactivityResetTime`: 无活动重置时间（默认: 5分钟）

2. **活动监听**
   - 文本编辑器内容变化（键盘输入）
   - 编辑器选择变化（鼠标点击、键盘导航）
   - 活动编辑器切换（切换文件）
   - 命令执行（各种用户操作）
   - 工作区变化
   - 配置变化

3. **自动重置逻辑**
   - 当用户无活动超过设定时间后，下次有活动时自动重置所有计时器
   - 显示友好的提示信息

4. **状态显示**
   - 在状态查看中显示活动检测状态和无活动时长
   - 专门的测试命令查看详细状态

## 测试步骤

### 1. 基础配置测试

```json
// 在 VS Code 设置中配置
{
    "movedYet.enableActivityDetection": true,
    "movedYet.inactivityResetTime": 1  // 设置为1分钟便于测试
}
```

### 2. 功能测试

1. **启动插件**
   - 重新加载 VS Code 窗口
   - 插件会自动启动活动检测

2. **查看状态**
   - 按 `Ctrl+Shift+P`
   - 运行命令: `动了么？: 显示提醒状态`
   - 应该显示活动检测状态

3. **测试活动检测**
   - 按 `Ctrl+Shift+P`
   - 运行命令: `动了么？: 测试活动检测`
   - 查看当前无活动时长

4. **测试自动重置**
   - 等待超过设定的无活动时间（如1分钟）
   - 然后进行任何编辑操作（输入文字、点击等）
   - 应该看到计时器重置的提示信息

### 3. 配置测试

1. **禁用功能**
   ```json
   {
       "movedYet.enableActivityDetection": false
   }
   ```
   - 活动检测应该停止工作

2. **调整时间**
   ```json
   {
       "movedYet.inactivityResetTime": 10  // 10分钟
   }
   ```
   - 重置阈值应该更新

## 监听的活动类型

1. **键盘活动**
   - 在编辑器中输入文字
   - 使用键盘快捷键
   - 键盘导航（方向键等）

2. **鼠标活动**
   - 点击编辑器
   - 选择文本
   - 切换文件标签

3. **其他活动**
   - 执行命令
   - 打开/关闭文件
   - 更改设置

## 预期行为

1. **正常工作时**: 活动检测静默运行，不影响用户体验
2. **长时间无活动**: 系统等待用户回归
3. **用户回归**: 自动重置计时器并显示友好提示
4. **配置变更**: 立即应用新设置

## 故障排除

如果功能不工作，检查：

1. **配置是否正确**
   ```bash
   # 查看当前配置
   code --list-extensions
   ```

2. **控制台日志**
   - 打开开发者工具 (`Help > Toggle Developer Tools`)
   - 查看控制台是否有错误信息

3. **重新加载窗口**
   - `Ctrl+Shift+P` -> `Developer: Reload Window`

## 技术实现

- **服务**: `ActivityDetectionService` 单例模式
- **监听器**: 使用 VS Code API 监听各种事件
- **定时器**: 智能管理无活动检测定时器
- **集成**: 与现有计时器服务无缝集成